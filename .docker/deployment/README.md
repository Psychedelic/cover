# Docker image used to test deployments 

## Building                                                                                                                                             

Build new deploy docker based on current code.

```
docker build -t fleek/f3o -f .docker/deployment/Dockerfile . 
```

## Running 
docker run --rm -ti --name fleek \
  -e CANISTERIUM_CANISTER_ID="rrkah-fqaaa-aaaaa-aaaaq-cai" \
  -e PAT=YOUR_GIT_PERSONAL_ACCESS_TOKEN \
  -e DFX_NETWORK=ic \
  -p 5000:5000 --entrypoint=bash \
  fleek/f3o


## Testing Deployment 

### Front End Deployment 
Inside of the docker container run:
```sh
.scripts/setup-fe.sh
```

### Back End Deployment
Inside of the docker container configure your DFX_IDENTITY and DFX_WALLETS.
For more info read [IC Deploy Action](https://github.com/FleekHQ/IC-Deploy-Action)

```sh
# setup DFX identity and wallet credentials
export DFX_IDENTITY="-----BEGIN PRIVATE KEY-----\r\n[CONTENT_OF_PK]\r\n-----END PRIVATE KEY-----\r\n"                              
export DFX_WALLETS="{ \"identities\": { \"default\": { \"ic\": \"aanaa-xaaaa-aaaah-aaaaa-aaa\" } } }" \
# run setup-be script 
.scripts/setup-be.sh
```

### Testing FE through serve
To test the FE compiled code that was generated by `setup-fe.sh` run: 
```sh
serve -s packages/dashboard/build
```

And then inside of your browser access `http://localhost:5000`
